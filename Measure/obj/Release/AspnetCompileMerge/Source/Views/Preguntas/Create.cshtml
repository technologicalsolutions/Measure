@using Measure.ViewModels.Pregunta
@model ViewQuestion
@{
    ViewBag.formShow = "show";
    ViewBag.PreguntasActive = "active";
    ViewBag.Title = "Preguntas";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@section style{
    @Styles.Render("~/Content/select2")
}
@section scriptsHead{
    @Scripts.Render("~/bundles/select2")
}
<div class="container">
    @Html.HiddenFor(model => model.ClienteId)
    <div class="row align-items-center p-2 my-2 text-white rounded shadow-sm custom-backgroun-2">
        <div class="col-4">
            <div class="d-flex align-items-center">
                <img class="me-2" src="@Url.Content("~/Content/images/Icono.png")" width="36">
                <div class="lh-1">
                    <h1 class="h3 mb-0 text-white lh-1">@ViewBag.Title Pregunta</h1>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="card">
            <div class="card-header">
                <ul class="nav nav-tabs card-header-pills" id="TipoPreguntas" role="tablist">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" id="abierta-tab" data-bs-toggle="tab" data-bs-target="#abierta"><i class="bi-input-cursor-text"></i> @Measure.Recursos.Recurso.ControlAbierto</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="boolean-tab" data-bs-toggle="tab" data-bs-target="#boolean"><i class="bi-check2-circle"></i>@Measure.Recursos.Recurso.ControlBooleano</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="cerrado-tab" data-bs-toggle="tab" data-bs-target="#cerrado"><i class="bi-ui-checks"></i>@Measure.Recursos.Recurso.ControlCerrado</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link " href="#" id="matriz-tab" data-bs-toggle="tab" data-bs-target="#matriz"><i class="bi-ui-checks-grid"></i>@Measure.Recursos.Recurso.ControlMatriz</a>
                    </li>
                </ul>
            </div>
            <div class="card-body">
                <div class="tab-content">
                    <div class="tab-pane active" id="abierta" role="tabpanel" aria-labelledby="abierta-tab">
                        <div class="row">
                            <div class="col-12">
                                <div class="form-group">
                                    <label class="form-label">Texto Pregunta</label>
                                    <div class="col-md-12">
                                        <textarea class="form-control npregunta" id="PreguntaControlA" rows="3"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-4">
                                <div class="form-group">
                                    <label class="form-label">Idioma Pregunta</label>
                                    <div class="col-md-12">
                                        <select class="form-select idioma" data-init-plugin="select2" id="IdiomaControlA">
                                            <option value="1">@Measure.Recursos.Recurso.IdiomaEspanol</option>
                                            <option value="2">@Measure.Recursos.Recurso.IdiomaIngles</option>
                                            <option value="3">@Measure.Recursos.Recurso.IdiomaPortugues</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="form-group">
                                    <label class="form-check-label" for="EstadoControlA">
                                        Estado: Activo / Inactivo
                                    </label>
                                    <br />
                                    <div class="mt-3">
                                        <input type="checkbox" class="form-check-input" id="EstadoControlA" checked />
                                    </div>

                                </div>
                            </div>
                            <div class="col-4">
                                <div class="form-group">
                                    <label class="form-check-label" for="ConfControlA">
                                        Confirmación: Activo / Inactivo
                                    </label>
                                    <br />
                                    <div class="mt-3">
                                        <input type="checkbox" class="form-check-input" id="ConfControlA" checked />
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 mt-2">
                                <div class="form-group">
                                    <label>Tipo de Pregunta</label>
                                    <div class="col-md-12 mt-2">
                                        <select class="form-select" data-init-plugin="select2" id="TipoPreguntaAbierta" style="width:100%" onchange="TipoPregunta(this)">
                                            <option value="0">@Measure.Recursos.Recurso.Ca_Entrada</option>
                                            <option value="1">@Measure.Recursos.Recurso.Ca_Entrada_Descripcion</option>
                                            <option value="3">@Measure.Recursos.Recurso.Ca_Entrada_Multiple</option>
                                            <option value="4">@Measure.Recursos.Recurso.Ca_Texto_Multiple</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row tipos" id="0">
                            <div class="mt-2">
                                <div class="form-group">
                                    <label class="control-label">Tipo Campo</label>
                                    <div class="col-md-12 mt-2">
                                        <select name="TipoDatoIdAbierta" id="TipoDatoIdAbierta" class="form-select" data-init-plugin="select2" style="width:100%">
                                            <option value="0">@Measure.Recursos.Recurso.Td_datetime</option>
                                            <option value="1">@Measure.Recursos.Recurso.Td_email</option>
                                            <option value="2">@Measure.Recursos.Recurso.Td_number</option>
                                            <option value="4">@Measure.Recursos.Recurso.Td_tel</option>
                                            <option value="5">@Measure.Recursos.Recurso.Td_text</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row tipos" id="1" style="display:none">
                            <div class="row mt-2">
                                <div class="col-12">
                                    <div class="form-group  mt-2">
                                        <label class="form-label">Texto Antes</label>
                                        <div class="col-md-12">
                                            <input type="text" class="form-control" id="Ca_TxtAntes" />
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-group  mt-2">
                                        <label class="control-label">Tipo Campo</label>
                                        <div class="col-md-12 mt-2">
                                            <select name="TipoDatoIdAbiertaC" id="TipoDatoIdAbiertaC" class="form-select" data-init-plugin="select2" style="width:100%">
                                                <option value="0">@Measure.Recursos.Recurso.Td_datetime</option>
                                                <option value="1">@Measure.Recursos.Recurso.Td_email</option>
                                                <option value="2">@Measure.Recursos.Recurso.Td_number</option>
                                                <option value="4">@Measure.Recursos.Recurso.Td_tel</option>
                                                <option value="5">@Measure.Recursos.Recurso.Td_text</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <div class="form-group  mt-2">
                                        <label class="form-label">Texto Despues</label>
                                        <div class="col-md-12">
                                            <input type="text" class="form-control" id="Ca_TxtDespues" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row tipos" id="4" style="display:none">
                            <div class="row">
                                <div class="col-12 col-sm-4  mt-2">
                                    <div class="form-group">
                                        <label class="form-label">Cantidad de Descripciones</label>
                                        <div class="col-md-12">
                                            <input type="text" class="form-control" onkeypress="NumberOnly(event)" value="1" id="ColumnasEntradaMultiple" />
                                        </div>
                                    </div>
                                    <button class="btn btn-primary btn-sm rounded-pill py-0 mt-4" type="button" onclick="GenerarEntradaMultiple()"><i class="bi-binoculars"></i> Generar Campos</button>
                                </div>
                                <div class="col-12 col-sm-4 mt-2" id="DescripcionesMultiple">

                                </div>
                                <div class="col-12 col-sm-4 mt-2" id="CamposMultiple">

                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 mt-2 text-center">
                                <input type="hidden" name="ControlEntradaTipo" id="ControlEntradaTipo" />
                                <button class="btn btn-success btn-sm rounded-pill py-0" type="button" id="BtnSaveAbierta" onclick="CrearPreguntaAbierta()"><i class="bi-save"></i> Crear Pregunta</button>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane" id="boolean" role="tabpanel" aria-labelledby="boolean-tab">
                        <div class="row">
                            <div class="col-12">
                                <div class="form-group">
                                    <label class="form-label">Texto Pregunta</label>
                                    <div class="col-md-12">
                                        <textarea class="form-control npregunta" id="PreguntaControlB" rows="3"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-4">
                                <div class="form-group">
                                    <label class="form-label">Idioma Pregunta</label>
                                    <div class="col-md-12">
                                        <select class="form-select idioma" data-init-plugin="select2" id="IdiomaControlB">
                                            <option value="1">@Measure.Recursos.Recurso.IdiomaEspanol</option>
                                            <option value="2">@Measure.Recursos.Recurso.IdiomaIngles</option>
                                            <option value="3">@Measure.Recursos.Recurso.IdiomaPortugues</option>
                                        </select>
                                    </div>
                                </div>
                            </div>                            
                            <div class="col-4">
                                <div class="form-group">
                                    <label class="form-check-label" for="EstadoControlB">
                                        Estado: Activo / Inactivo
                                    </label>
                                    <br />
                                    <div class="mt-3">
                                        <input type="checkbox" class="form-check-input" id="EstadoControlB" checked />
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-6">
                                <label class="form-label mt-2">Tipo de pregunta</label>
                                <br />
                                <div class="form-check form-check-inline mt-2">
                                    <input class="form-check-input" type="radio" name="TipoValor" value="0" checked>
                                    <label class="form-check-label" for="exampleRadios1">
                                        Si / No
                                    </label>
                                </div>
                                <div class="form-check form-check-inline mt-2">
                                    <input class="form-check-input" type="radio" name="TipoValor" value="1">
                                    <label class="form-check-label" for="exampleRadios2">
                                        Falso / Verdadero
                                    </label>
                                </div>
                            </div>
                            <div class="col-6">
                                <label class="form-label mt-2">Respuesta Correcta</label>
                                <br />
                                <div class="form-check form-check-inline mt-2">
                                    <input class="form-check-input" type="radio" name="RespuestaCorrecta" value="0">
                                    <label class="form-check-label">
                                        Si / Verdadero
                                    </label>
                                </div>
                                <div class="form-check form-check-inline mt-2">
                                    <input class="form-check-input" type="radio" name="RespuestaCorrecta" value="1">
                                    <label class="form-check-label">
                                        No / Falso
                                    </label>
                                </div>
                                <br />
                            </div>
                            <div class="col-12 text-center mt-4">
                                <button class="btn btn-success btn-sm rounded-pill py-0" type="button" onclick="CrearPreguntaBool()"><i class="bi-save"></i> Guardar Pregunta</button>
                            </div>
                        </div>
                    </div>
                    <div class="tab-pane" id="cerrado" role="tabpanel" aria-labelledby="cerrado-tab">
                        <div class="row">
                            <div class="col-12">
                                <div class="form-group">
                                    <label class="form-label">Texto Pregunta</label>
                                    <div class="col-md-12">
                                        <textarea class="form-control npregunta" id="PreguntaControlC" rows="3"></textarea>
                                    </div>
                                </div>
                            </div>                            
                        </div>
                        <div class="row mt-2">
                            <div class="col-12 col-md-3">
                                <div class="form-group">
                                    <label class="form-label">Idioma Pregunta</label>
                                    <div class="col-md-12">
                                        <select class="form-select idioma" data-init-plugin="select2" id="IdiomaControlC">
                                            <option value="1">@Measure.Recursos.Recurso.IdiomaEspanol</option>
                                            <option value="2">@Measure.Recursos.Recurso.IdiomaIngles</option>
                                            <option value="3">@Measure.Recursos.Recurso.IdiomaPortugues</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-md-2">
                                <div class="form-group">
                                    <label class="form-check-label" for="EstadoControlC">
                                        Estado: Activo / Inactivo
                                    </label>
                                    <br />
                                    <div class="mt-3">
                                        <input type="checkbox" class="form-check-input" id="EstadoControlC" checked />
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-md-3">
                                <div class="form-group">
                                    <label>Tipo de Pregunta</label>
                                    <div class="col-md-12">
                                        <select class="form-select mt-2" data-init-plugin="select2" style="width:100%" id="CerradoId" onchange="ActiveOptions(this.value)">
                                            <option value="Cc_Desplegable">@Measure.Recursos.Recurso.Cc_Desplegable</option>
                                            <option value="Cc_Enlistada">@Measure.Recursos.Recurso.Cc_Enlistada</option>
                                            <option value="Cc_Enlistada_Otro">@Measure.Recursos.Recurso.Cc_Enlistada_Otro</option>
                                            <option value="Cc_Enlistada_Anidada">@Measure.Recursos.Recurso.Cc_Enlistada_Anidada</option>
                                            <option value="Cc_Opcion_Multiple">@Measure.Recursos.Recurso.Cc_Opcion_Multiple</option>
                                            <option value="Cc_Opcion_Multiple_Otro">@Measure.Recursos.Recurso.Cc_Opcion_Multiple_Otro</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-md-4">
                                <div class="form-group" id="Maestras">
                                    <label>Clientes</label>
                                    @Html.DropDownList("opciones", Model.Maestras, htmlAttributes: new { @class = "form-select mt-2", data_init_plugin = "select2" })
                                </div>
                                <div class="form-group" id="Cantidad" style="display:none">
                                    <label>Cantidad de opciones</label>
                                    <input type="text" class="form-control mt-2" onkeypress="NumberOnly(event)" value="1" id="CantidadOpciones" />
                                </div>
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-12 text-center mt-2">
                                <button class="btn btn-primary btn-sm rounded-pill py-0" type="button" id="MotrarCerrados" onclick="MotrarCerrados()" style="display:none"><i class="bi-binoculars"></i> Mostrar</button>
                                <button class="btn btn-success btn-sm rounded-pill py-0" type="button" onclick="CrearPreguntaCerrad()" id="BtnSaveCerrado"><i class="bi-binoculars"></i> Crear Pregunta</button>
                            </div>
                        </div>
                        <div class="row tipoCerrado" id="ControlDesplegable"></div>
                        <div class="row tipoCerrado" id="ControlEnlistados" style="display:none">
                            <div class="col-12 mt-2">
                                <div class="row" id="DivOtraRespuesta" style="display:none">
                                    <div class="col-12 col-sm-8 mt-2">
                                        <div class="form-group">
                                            <label class="form-label">Texto otra respuesta</label>
                                            <div class="col-md-12">
                                                <input type="text" class="form-control" id="TextOtraRespuesta" name="TextOtraRespuesta" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-12 col-sm-4 mt-2">
                                        <div class="form-group">
                                            <label class="control-label">Tipo Campo</label>
                                            <div class="col-md-12 mt-2">
                                                <select name="TipoDatoIdAbierta" id="TipoDatoIdAbierta" class="form-select" data-init-plugin="select2" style="width:100%">
                                                    <option value="0">@Measure.Recursos.Recurso.Td_datetime</option>
                                                    <option value="1">@Measure.Recursos.Recurso.Td_email</option>
                                                    <option value="2">@Measure.Recursos.Recurso.Td_number</option>
                                                    <option value="4">@Measure.Recursos.Recurso.Td_tel</option>
                                                    <option value="5">@Measure.Recursos.Recurso.Td_text</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row" id="RenderCerrado"></div>
                            </div>
                        </div>
                        <div class="row tipoCerrado" id="ControlAnidado" style="display:none">
                            <div class="row">
                                <div class="col-12 col-sm-6 mt-2">
                                    <div class="form-group">
                                        <label>Tipo de Pregunta</label>
                                        <div class="col-md-12 mt-2">
                                            <select class="form-select" data-init-plugin="select2" style="width:100%" id="PrAnidadas" onchange="LoadValores(this.value)"></select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-12 col-sm-6 mt-2">
                                    <div class="row">
                                        <div class="col-12">
                                            <label>Valores anidar</label>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-12 mt-2" id="ValoresControl"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="row" id="ControlesCerrados"></div>
                        </div>
                    </div>
                    <div class="tab-pane" id="matriz" role="tabpanel" aria-labelledby="matriz-tab">
                        <div class="row">
                            <div class="col-12">
                                <div class="form-group">
                                    <label class="form-label">Texto Pregunta</label>
                                    <div class="col-md-12">
                                        <textarea class="form-control npregunta" id="PreguntaControlM" rows="3"></textarea>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-12 col-sm-4">
                                <div class="form-group">
                                    <label class="form-label">Idioma Pregunta</label>
                                    <div class="col-md-12">
                                        <select class="form-select idioma" data-init-plugin="select2" id="IdiomaControlM">
                                            <option value="1">@Measure.Recursos.Recurso.IdiomaEspanol</option>
                                            <option value="2">@Measure.Recursos.Recurso.IdiomaIngles</option>
                                            <option value="3">@Measure.Recursos.Recurso.IdiomaPortugues</option>
                                        </select>
                                    </div>
                                </div>
                            </div>                            
                            <div class="col-12 col-sm-4">
                                <label class="form-label">Tipo de Matriz</label>
                                <br />
                                <div class="form-check form-check-inline mt-2">
                                    <input class="form-check-input" type="radio" name="Radio" value="0" checked>
                                    <label class="form-check-label" for="exampleRadios1">
                                        Unica
                                    </label>
                                </div>
                                <div class="form-check form-check-inline mt-2">
                                    <input class="form-check-input" type="radio" name="Radio" value="1">
                                    <label class="form-check-label" for="exampleRadios2">
                                        Multiple
                                    </label>
                                </div>
                                <div class="form-check form-check-inline mt-2">
                                    <input class="form-check-input" type="radio" name="Radio" value="2">
                                    <label class="form-check-label" for="exampleRadios2">
                                        Rango
                                    </label>
                                </div>
                            </div>
                            <div class="col-12 col-sm-4">
                                <div class="form-group">
                                    <label class="form-check-label" for="EstadoControlC">
                                        Estado: Activo / Inactivo
                                    </label>
                                    <br />
                                    <div class="mt-3">
                                        <input type="checkbox" class="form-check-input" id="EstadoControlM" checked />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 col-2-5">
                                <div class="form-group">
                                    <label class="form-label">Cantidad de Columnas</label>
                                    <div class="col-md-12">
                                        <input type="text" class="form-control" onkeypress="NumberOnly(event)" value="1" id="ColumnasMatriz" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-2-5">
                                <div class="form-group">
                                    <label class="form-label">Cantidad de Filas</label>
                                    <div class="col-md-12">
                                        <input type="text" class="form-control" onkeypress="NumberOnly(event)" value="1" Id="FilasMatriz" />
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-2-5">
                                <div class="form-group">
                                    <label class="form-label">Comienza en:</label>
                                    <div class="col-md-12">
                                        <input type="text" class="form-control" onkeypress="NumberOnly(event)" value="1" id="MinimoMatriz" disabled />
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-2-5">
                                <div class="form-group">
                                    <label class="form-label">Finaliza en:</label>
                                    <div class="col-md-12">
                                        <input type="text" class="form-control" onkeypress="NumberOnly(event)" value="1" Id="MaximoMatriz" disabled />
                                    </div>
                                </div>
                            </div>
                            <div class="col-12 col-2-5">
                                <div class="form-group">
                                    <label class="form-label">Pasos</label>
                                    <div class="col-md-12">
                                        <input type="text" class="form-control" onkeypress="NumberOnly(event)" value="1" Id="PasoMatriz" disabled />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 col-sm-6 text-center mt-4">
                                <button class="btn btn-primary btn-sm rounded-pill py-0" type="button" onclick="VisualizarMatriz()"><i class="bi-binoculars"></i>Generar Matriz</button>
                            </div>
                            <div class="col-12 col-sm-6 text-center mt-4">
                                <button class="btn btn-success btn-sm rounded-pill py-0" type="button" onclick="CrearMatriz()" id="BtnSaveMatriz" disabled><i class="bi-save"></i> Guardar Matriz</button>
                            </div>
                        </div>
                        <div class="row mt-4">
                            <div class="col-12 col-sm-6" id="FilasM">

                            </div>
                            <div class="col-12 col-sm-6" id="ColumnasM">

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row">
    @using (Html.BeginRouteForm("Preguntas", FormMethod.Post, new { id = "FrmPrg" }))
    {
        <input type="hidden" name="Cliente" id="Cliente" />
    }
</div>
@section scripts{
    <script src="@Measure.Recursos.Recurso.LenguajeSelectScript" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $.each($(".idioma"), function (pos, item) {
                $(item).val('@Model.Idioma');
            });

            $('select').select2({
                "theme": "bootstrap-5",
                "language": SelectedTranslate
            });

            $("input:radio").change(function () {
                if (this.value == "2") {
                    $("#MinimoMatriz").removeAttr("disabled");
                    $("#MaximoMatriz").removeAttr("disabled");
                    $("#PasoMatriz").removeAttr("disabled");
                } else {
                    $("#MinimoMatriz").attr("disabled", "disabled");
                    $("#MaximoMatriz").attr("disabled", "disabled");
                    $("#PasoMatriz").attr("disabled", "disabled");
                }
            })
        });

        function ActiveOptions(Valor) {
            if (Valor == 'Cc_Desplegable') {
                $("#Cantidad").hide();
                $("#MotrarCerrados").hide();
                $("#Maestras").show();
            } else {
                $("#Cantidad").show();
                $("#MotrarCerrados").show();
                $("#Maestras").hide();
            }
        }

        function TipoPregunta(Obj) {

            var Tipo = Obj.value;
            $("#ControlEntradaTipo").val(Tipo);
            $(".tipos").hide();

            switch (Tipo) {
                case "1":
                    $("#Ca_TxtAntes").val("");
                    $("#Ca_TxtDespues").val("");
                    break;
                case "4":
                    $("#DescripcionesMultiple").html('');
                    $("#CamposMultiple").html('');
                    break;
            }

            $("#" + Tipo).show();
        }

        function GenerarEntradaMultiple() {
            var columnas = parseInt($("#ColumnasEntradaMultiple").val());
            var Html = '';
            Html += '<div class="row">';
            for (var a = 0; a < columnas; a++) {
                Html += '<div class="col-12 mt-2">';
                Html += '<label>Texto Descripción Nro. ' + (a + 1) + '</label> <input class="form-control" name="Columna" />';
                Html += '</div>';
            }
            Html += '</div>';
            $("#DescripcionesMultiple").html("").html(Html);
            Html = '<div class="row">';
            for (var b = 0; b < columnas; b++) {
                Html += '<div class="col-12  mt-2">';
                Html += '<label>Control Descripción Nro. ' + (b + 1) + '</label>' + TipoDatosHtml();
                Html += '</div>';
            }
            Html += '</div>';
            $("#CamposMultiple").html("").html(Html);
        }

        function TipoDatosHtml() {
            var Html = '<select class="form-select" name="TipoDatoMultiple" data-init-plugin="select2" style="width:100%">';
            Html += '<option value="0">@Measure.Recursos.Recurso.Td_datetime</option>';
            Html += '<option value="1">@Measure.Recursos.Recurso.Td_email</option>';
            Html += '<option value="2">@Measure.Recursos.Recurso.Td_number</option>';
            Html += '<option value="4">@Measure.Recursos.Recurso.Td_tel</option>';
            Html += '<option value="5">@Measure.Recursos.Recurso.Td_text</option>';
            Html += '</select>';
            return Html;
        }

        function CrearPreguntaAbierta() {
            var message = '';

            var params = {
                Data: {
                    ClienteId: $("#ClienteId").val(),
                    TextoPregunta: $("#PreguntaControlA").val(),
                    Idioma: parseInt($("#IdiomaControlA").val()),
                    EstadoPregunta: document.getElementById("EstadoControlA").checked,
                    Confirmacion: document.getElementById("ConfControlA").checked,                    
                    TipoAbierta: $("#TipoPreguntaAbierta").val()
                }
            };

            if (params.Data.TextoPregunta == "") {
                message += '<p>Debe de escribir el texto de la pregunta.</p>';
            }

            if (params.Data.TipoAbierta == '0') {
                params.Data.TipoDato = $("#TipoDatoIdAbierta").val();
            } else if (params.Data.TipoAbierta == '1' || params.Data.TipoAbierta == '2') {
                params.Data.DescripcionPre = $("#Ca_TxtAntes").val();
                if (params.Data.DescripcionPre == "") {
                    message += '<p>Debe de escribir Descripcion previa.</p>';
                }
                params.Data.TipoDato = $("#TipoDatoIdAbiertaC").val();
                params.Data.DescripcionPos = $("#Ca_TxtDespues").val();
            }
            else if (params.Data.TipoAbierta == '4') {
                params.Data.Multilinea = true;
            } else {
                params.Data.MultiCampo = true;
                var _DescripcionPre = '';
                $.each(document.getElementsByName("Columna"), function (pos, item) {
                    if (item.value != '') {
                        _DescripcionPre += item.value + '|';
                    }
                })
                _DescripcionPre = _DescripcionPre.substring(0, (_DescripcionPre.length - 1));

                var _DescripcionPos = '';
                $.each(document.getElementsByName("TipoDatoMultiple"), function (pos, item) {
                    _DescripcionPos += item.value + ',';
                })
                _DescripcionPos = _DescripcionPos.substring(0, (_DescripcionPos.length - 1));

                params.Data.DescripcionPre = _DescripcionPre;
                params.Data.DescripcionPos = _DescripcionPos;

                if (_DescripcionPre == "") {
                    message += '<p>Debe de escribir todas las descripciones</p>';
                }
                if (_DescripcionPre.split('|').length != document.getElementsByName("Columna").length) {
                    message += '<p>Debe de escribir todas las descripciones</p>';
                }
            }

            if (message == '') {
                $.ajax({
                    url: '@Url.Action("GuardarControlAbierto", "Preguntas")',
                    method: 'Post',
                    data: params,
                    success: function (result) {
                        $("#Cliente").val(result);
                        DeseaContinuar();
                    },
                    error: function (Error) {
                        console.log(Error);
                    }
                });
            } else {
                ErrorCreate(message);
            }
        }

        function CrearPreguntaBool() {
            var message = '';
            var _RespuestaCorrecta = $('input:radio[name=RespuestaCorrecta]:checked').val();

            var params = {
                Data: {
                    ClienteId: $("#ClienteId").val(),
                    TextoPregunta: $("#PreguntaControlB").val(),
                    Idioma: parseInt($("#IdiomaControlB").val()),
                    EstadoPregunta: document.getElementById("EstadoControlB").checked,                    
                    TipoValor: $('input:radio[name=TipoValor]:checked').val() == "0" ? false : true,
                    RespuestaCorrecta: _RespuestaCorrecta == undefined ? null : _RespuestaCorrecta
                }
            };

            if (params.Data.TextoPregunta == "") {
                message += '<p>Debe de escribir el texto de la pregunta.</p>';
            }

            if (message == '') {
                $.ajax({
                    url: '@Url.Action("GuardarControlBoolean", "Preguntas")',
                    method: 'Post',
                    data: params,
                    success: function (result) {
                        $("#Cliente").val(result);
                        DeseaContinuar();
                    },
                    error: function (Error) {
                        console.log(Error);
                    }
                });
            } else {
                ErrorCreate(message);
            }
        }

        function MotrarCerrados() {
            $(".tipoCerrado").hide();
            var tipo = $("#CerradoId").val();
            var Html = '';

            var columnas = parseInt($("#CantidadOpciones").val());

            Html += '<div class="row"><div class="col-12 col-sm-6 mt-2">';
            for (var a = 0; a < columnas; a++) {
                Html += '<div class="row mt-2"><div class="col-12 mt-2">';
                Html += '<label>Valor Opción Nro. ' + (a + 1) + '</label> <input class="form-control" name="OpcionValor" />';
                Html += '</div></div>';
            }
            Html += '</div>';
            Html += '<div class="col-12 col-sm-6 mt-2">';
            for (var b = 0; b < columnas; b++) {
                Html += '<div class="row mt-2"><div class="col-12 mt-2">';
                Html += '<label>Texto Opción Nro. ' + (b + 1) + '</label> <input class="form-control" name="OpcionText" />';
                Html += '</div></div>';
            }
            Html += '</div></div>';

           if (tipo == 'Cc_Enlistada_Anidada') {
                $("#RenderCerrado").html('')
                AnidarPreguntas()
                $("#ControlesCerrados").html('').html(Html);
                $("#ControlAnidado").show();
            }
            else {
                if (tipo == 'Cc_Enlistada_Otro' || tipo == 'Cc_Opcion_Multiple_Otro') {
                    $("#DivOtraRespuesta").show();
                } else {
                    $("#DivOtraRespuesta").hide();
                }
                $("#ControlDesplegable").html('');
                $("#ControlEnlistados").show();
                $("#RenderCerrado").html('').html(Html);
            }
            document.getElementById("BtnSaveCerrado").disabled = false;
        }

        function AnidarPreguntas() {
            var params = {
                Data: {
                    ClienteId: $("#ClienteId").val(),
                    Idioma: $("#IdiomaControlC").val(),
                }
            };
            $.ajax({
                url: '@Url.Action("BuscarAnidarPreguntas", "Preguntas")',
                method: 'Post',
                data: params,
                success: function (result) {
                    var Html = '';
                    $.each(result, function (pos, item) {
                        Html += '<option value="' + item.Value + '">' + item.Text + '</option>';
                        if (pos == 0) {
                            LoadValores(item.Value);
                        }
                    });
                    $("#PrAnidadas").html(Html);
                    $("#PrAnidadas").select2("destroy");
                    $("#PrAnidadas").select2({
                        "width": 'resolve',
                        "theme": "bootstrap-5",
                        "language": SelectedTranslate
                    });
                },
                error: function (Error) {
                    console.log(Error);
                }
            });
        }

        function LoadValores(ControlId) {
            var params = {
                Data: {
                    ControlId: ControlId,
                }
            };
            $.ajax({
                url: '@Url.Action("BuscarValoreControl", "Preguntas")',
                method: 'Post',
                data: params,
                success: function (result) {
                    var DataTextos = result.Textos.split('|');
                    var DataValores = result.Valores.split('|');

                    var Html = '';
                    for (var a = 0; a < DataTextos.length; a++) {
                        Html += '<div class="row"><div class="col-12"><div class="form-check form-check-inline mt-2">';
                        Html += '<input class="form-check-input" type="radio" name="PadreId" value="' + DataValores[a]+'" checked>';
                        Html += '<label class="form-check-label">' + DataTextos[a] +'</label>';
                        Html += '</div></div></div>';
                    }

                    $("#ValoresControl").html(Html);

                },
                error: function (Error) {
                    console.log(Error);
                }
            });
        }

        function CrearPreguntaCerrad() {
            var message = '';
            var params = {
                Data: {
                    ClienteId: $("#ClienteId").val(),
                    TextoPregunta: $("#PreguntaControlC").val(),
                    Idioma: parseInt($("#IdiomaControlC").val()),
                    EstadoPregunta: document.getElementById("EstadoControlC").checked,                    
                }
            };

            if (params.Data.TextoPregunta == "") {
                message += '<p>Debe de escribir el texto de la pregunta.</p>';
            }

            var tipo = $("#CerradoId").val();
            var _TipoCerrada = 0; //default Cc_Desplegable

            if (tipo == 'Cc_Enlistada') {
                _TipoCerrada = 1;
                params.Data.Radio = true;
            } else if (tipo == 'Cc_Enlistada_Otro') {
                _TipoCerrada = 2;
                params.Data.Radio = true;
                params.Data.TieneControl = true;
                params.Data.ValorControl = $("#TextOtraRespuesta").val();
                params.Data.TipoDato = $("#TipoDatoIdAbierta").val();
            } else if (tipo == 'Cc_Enlistada_Anidada') {
                _TipoCerrada = 3;
                params.Data.Radio = true;
                params.Data.PadreId = $("#PrAnidadas").val();
                params.Data.RespuestaCorrecta = $('input:radio[name=PadreId]:checked').val();
            } else if (tipo == 'Cc_Opcion_Multiple') {
                _TipoCerrada = 4;
                params.Data.Radio = false;
            } else if (tipo == 'Cc_Opcion_Multiple_Otro') {
                _TipoCerrada = 5;
                params.Data.Radio = false;
                params.Data.TieneControl = true;
                params.Data.ValorControl = $("#TextOtraRespuesta").val();
                params.Data.TipoDato = $("#TipoDatoIdAbierta").val();
            }

            params.Data.TipoCerrada = _TipoCerrada;

            var _OpcionValor = '';
            var _OpcionText = '';

            if (_TipoCerrada == 0) {
                _OpcionValor = $("#opciones").val();

                if (_OpcionValor == "") {
                    message += '<p>Debe de crear maestras para seleccionar.</p>';
                } else {
                    _OpcionText = $("#opciones option[value=" + _OpcionValor + "]").text();
                }
            } else {
                $.each(document.getElementsByName("OpcionValor"), function (pos, item) {
                    if (item.value != '') {
                        _OpcionValor += item.value + '|';
                    }
                })
                _OpcionValor = _OpcionValor.substring(0, (_OpcionValor.length - 1));

                $.each(document.getElementsByName("OpcionText"), function (pos, item) {
                    _OpcionText += item.value + '|';
                })
                _OpcionText = _OpcionText.substring(0, (_OpcionText.length - 1));

                if (_OpcionValor == "") {
                    message += '<p>Debe de escribir todos los valores de las opciones</p>';
                }
                if (_OpcionValor.split('|').length != document.getElementsByName("OpcionValor").length) {
                    message += '<p>Debe de escribir todos los valores de las opciones</p>';
                }
                if (_OpcionText == "") {
                    message += '<p>Debe de escribir todos los textos de las opciones</p>';
                }
                if (_OpcionText.split('|').length != document.getElementsByName("OpcionText").length) {
                    message += '<p>>Debe de escribir todos los textos de las opciones</p>';
                }

                if (params.Data.TieneControl) {
                    if ($("#TextOtraRespuesta").val() == '') {
                        message += '<p>Se requiere el texto adicional.</p>';
                    } else {
                        params.Data.TieneControl = true;
                        params.Data.ValorControl = $("#TextOtraRespuesta").val();
                    }
                }
            }

            params.Data.Textos = _OpcionText;
            params.Data.Valores = _OpcionValor;


            if (message == '') {
                 $.ajax({
                    url: '@Url.Action("GuardarControlCerrado", "Preguntas")',
                    method: 'Post',
                    data: params,
                    success: function (result) {
                         $("#Cliente").val(result);
                         DeseaContinuar();
                     },
                     error: function (Error) {
                         console.log(Error);
                     }
                 });
            } else {
                ErrorCreate(message);
            }
        }

        function VisualizarMatriz() {
            var filas = $("#FilasMatriz").val();
            var columnas = $("#ColumnasMatriz").val();
            var tipo = $('input:radio[name=Radio]:checked').val();

            var Html = '';
            Html += '<div class="row">';
            for (var b = 0; b < columnas; b++) {
                Html += '<div class="col-12">';
                Html += '<div class="row">';
                if (tipo == "2") {
                    Html += '<div class="col-12 col-md-8">';
                } else {
                    Html += '<div class="col-12 col-md-12">';
                }
                Html += '<label>Texto Columna Nro. ' + (b + 1) + '</label>';
                Html += '<input class="form-control" name="TextoColumna" /></div>';
                if (tipo == "2") {
                    Html += '<div class="col-12 col-md-4">';
                    Html += '<label>Pasos por Columna Nro. ' + (b + 1) + '</label>';
                    Html += '<input class="form-control pasoPorColumna" onkeypress="NumberOnly(event)"/></div>';
                }
                Html += '</div>';
            }
            Html += '</div>';
            $("#ColumnasM").html("").html(Html);
            Html = '<div class="row">';
            for (var a = 0; a < filas; a++) {
                Html += '<div class="col-12">';
                Html += '<label>Texto Fila Nro. ' + (a + 1) + '</label> <input class="form-control" name="TextoFila" />';
                Html += '</div>';
            }
            Html += '</div>';
            $("#FilasM").html("").html(Html);

            document.getElementById("BtnSaveMatriz").disabled = false;
        }

        function CrearMatriz() {
            var message = Array();
            var params = {
                Data: {
                    ControlId: $("#ControlId").val(),
                    PreguntaId: $("#Id").val(),
                    ClienteId: $("#ClienteId").val(),
                    TextoPregunta: $("#PreguntaControlM").val(),
                    Idioma: parseInt($("#IdiomaControlM").val()),
                    EstadoPregunta: document.getElementById("EstadoControlM").checked,
                }
            };

            if ($('input:radio[name=Radio]:checked').val() == '0') {
                params.Data.Radio = "radio";
            } else if ($('input:radio[name=Radio]:checked').val() == '1') {
                params.Data.Radio = "checkbox";
            } else {
                params.Data.Radio = "range";
            }

            if (params.Data.TextoPregunta == "") {
                message.push('<p>Debe de escribir el texto de la pregunta.</p>');
            }

            var _TextoFilas = '';
            $.each(document.getElementsByName("TextoFila"), function (pos, item) {
                if (item.value != '') {
                    _TextoFilas += item.value + '|';
                }
            })
            _TextoFilas = _TextoFilas.substring(0, (_TextoFilas.length - 1));

            var _TextoColumnas = '';
            $.each(document.getElementsByName("TextoColumna"), function (pos, item) {
                if (item.value != '') {
                    _TextoColumnas += item.value + '|';
                }
            })
            _TextoColumnas = _TextoColumnas.substring(0, (_TextoColumnas.length - 1));

            params.Data.TextoFilas = _TextoFilas;
            params.Data.TextoColumnas = _TextoColumnas;

            if (_TextoFilas == "") {
                message.push('<p>Debe de escribir todas las descripciones de las filas</p>');
            } else {
                if (_TextoFilas.split('|').length != document.getElementsByName("TextoFila").length) {
                    message.push('<p>Debe de escribir todas las descripciones de las filas</p>');
                }
            }

            if (_TextoColumnas == "") {
                message.push('<p>Debe de escribir todas las descripciones de las columnas</p>');
            } else {
                if (_TextoColumnas.split('|').length != document.getElementsByName("TextoColumna").length) {
                    message.push('<p>Debe de escribir todas las descripciones de las columnas</p>');
                }
            }


            if (params.Data.Radio == "range") {
                if ($("#MinimoMatriz").val() == "") {
                    message.push('<p>Debe de escribir en que valor empieza el rango</p>');
                } else {
                    params.Data.Min = parseInt($("#MinimoMatriz").val());
                }
                if ($("#MaximoMatriz").val() == "") {
                    message.push('<p>Debe de escribir en que valor termina el rango</p>');
                } else {
                    params.Data.Max = parseInt($("#MaximoMatriz").val());
                }
                if ($("#PasoMatriz").val() == "") {
                    message.push('<p>Debe de escribir en que valor termina el rango</p>');
                } else {
                    params.Data.Step = parseInt($("#PasoMatriz").val());
                }

                var pasosColumnas = '';
                var countEmpty = 0;
                var countTotal = 0;
                $.each($(".pasoPorColumna"), function (pos, item) {
                    if (item.value == '') {
                        countEmpty++;
                    } else {
                        countTotal += parseInt(item.value);
                        pasosColumnas += item.value + '|';
                    }
                })

                if (countEmpty > 0) {
                    message.push('<p>Debe de digitar todos los pasos por columna</p>');
                } else {
                    var totalPasos = (params.Data.Max - params.Data.Min) + 1;
                    if (totalPasos < countTotal) {
                        message.push('<p>Los pasos por columna no pueden ser mas que el rango seleccionado: ' + totalPasos + ' </p>');
                    } else if (totalPasos > countTotal) {
                        message.push('<p>Los pasos por columna no pueden ser menos que el rango seleccionado: ' + totalPasos + ' </p>');
                    } else {
                        pasosColumnas = pasosColumnas.substring(0, (pasosColumnas.length - 1));
                        params.Data.PasosPorColumna = pasosColumnas;
                    }
                }
            }

            if (message.length == 0) {
                $.ajax({
                    url: '@Url.Action("GuardarControlMatriz", "Preguntas")',
                    method: 'Post',
                    data: params,
                    success: function (result) {
                        $("#Cliente").val(result);
                        DeseaContinuar();
                    },
                    error: function (Error) {
                        console.log(Error);
                    }
                });
            } else {
                $.each(message, function (pos, item) {
                    ErrorCreate(item);
                })
            }
        }

        function ErrorCreate(message) {
            var type = 'danger';
            var duration = '5000';
            var ripple = true;
            var dismissible = true;
            var positionX = 'center';
            var positionY = 'top';
            window.notyf.open({
                type,
                message,
                duration,
                ripple,
                dismissible,
                position: {
                    x: positionX,
                    y: positionY
                }
            });
        }

        function DeseaContinuar() {
            Swal.fire({
                title: '¿Nueva pregunta?',
                text: "Desea seguir creando preguntas ",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                cancelButtonText: 'No',
                confirmButtonText: 'Sí'
            }).then((result) => {
                if (!result.value) {
                    $("#FrmPrg").submit();
                } else {
                    $.each($(".npregunta"), function (pos, item) {
                        $(item).val("");
                    })
                }
            });
        }
    </script>
}